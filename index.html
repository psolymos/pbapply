<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adding Progress Bar to *apply Functions • pbapply</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Adding Progress Bar to *apply Functions">
<meta name="description" content="A lightweight package that adds progress bar to vectorized R functions (*apply). The implementation can easily be added to functions where showing the progress is useful (e.g. bootstrap). The type and style of the progress bar (with percentages or remaining time) can be set through options. Supports several parallel processing backends including future.">
<meta property="og:description" content="A lightweight package that adds progress bar to vectorized R functions (*apply). The implementation can easily be added to functions where showing the progress is useful (e.g. bootstrap). The type and style of the progress bar (with percentages or remaining time) can be set through options. Supports several parallel processing backends including future.">
<script src="https://cdn.usefathom.com/script.js" data-site="KTMJHUPR" defer></script><link rel="icon" href="https://peter.solymos.org/favicon.ico">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">pbapply</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/peter-solymos/" aria-label="Linkedin"><span class="fa fa-linkedin"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/psolymos" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/psolymos" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="pbapply-adding-progress-bar-to-apply-functions-in-r">pbapply: adding progress bar to ’*apply’ functions in R<a class="anchor" aria-label="anchor" href="#pbapply-adding-progress-bar-to-apply-functions-in-r"></a>
</h1></div>
<p><a href="https://CRAN.R-project.org/package=pbapply" class="external-link"><img src="https://www.r-pkg.org/badges/version/pbapply" alt="CRAN version"></a> <a href="https://www.rdocumentation.org/packages/pbapply/" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/pbapply" alt="CRAN RStudio mirror downloads"></a> <a href="https://github.com/psolymos/pbapply/actions/workflows/check.yml" class="external-link"><img src="https://github.com/psolymos/pbapply/actions/workflows/check.yml/badge.svg" alt="check"></a></p>
<p>A lightweight package that adds progress bar to vectorized R functions (<code>*apply</code>). The implementation can easily be added to functions where showing the progress is useful (e.g. bootstrap). The type and style of the progress bar (with percentages or remaining time) can be set through options. The package supports several <a href="#parallel-backends">parallel processing backends</a>, such as snow-type clusters, multicore-type forking, and future.</p>
<p><img src="https://github.com/psolymos/pbapply/raw/master/images/pbapply-02.gif"></p>
<ul>
<li>
<a href="#pbapply-adding-progress-bar-to-apply-functions-in-r">pbapply: adding progress bar to ‘*apply’ functions in R</a>
<ul>
<li><a href="#versions">Versions</a></li>
<li>
<a href="#how-to-get-started">How to get started?</a>
<ul>
<li><a href="#id_1-you-are-not-yet-an-r-user">1. You are not yet an R user</a></li>
<li><a href="#id_2-you-are-an-r-user-but-havent-used-vectorized-functions-yet">2. You are an R user but haven’t used vectorized functions yet</a></li>
<li><a href="#id_3-you-are-an-r-user-familiar-with-vectorized-functions">3. You are an R user familiar with vectorized functions</a></li>
<li><a href="#id_4-you-are-a-seasoned-r-developer-writing-your-own-packages">4. You are a seasoned R developer writing your own packages</a></li>
</ul>
</li>
<li>
<a href="#how-to-add-pbapply-to-a-package">How to add pbapply to a package</a>
<ul>
<li><a href="#id_1-suggests-pbapply">1. Suggests: pbapply</a></li>
<li><a href="#id_2-dependsimports-pbapply">2. Depends/Imports: pbapply</a></li>
<li><a href="#customizing-the-progress-bar-in-your-package">Customizing the progress bar in your package</a></li>
<li><a href="#suppressing-the-progress-bar-in-your-functions">Suppressing the progress bar in your functions</a></li>
<li><a href="#working-with-a-future-backend">Working with a future backend</a></li>
</ul>
</li>
<li>
<a href="#examples">Examples</a>
<ul>
<li><a href="#command-line-usage">Command line usage</a></li>
<li><a href="#parallel-backends">Parallel backends</a></li>
<li><a href="#progress-with-shiny">Progress with Shiny</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="section level2">
<h2 id="versions">Versions<a class="anchor" aria-label="anchor" href="#versions"></a>
</h2>
<p>Install CRAN release version (recommended):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pbapply"</span><span class="op">)</span></span></code></pre></div>
<p>Development version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pbapply"</span>, repos <span class="op">=</span> <span class="st">"https://psolymos.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
<p>See user-visible changes in the <a href="https://github.com/psolymos/pbapply/blob/master/NEWS.md" class="external-link">NEWS</a> file.</p>
<p>Use the <a href="https://github.com/psolymos/pbapply/issues" class="external-link">issue tracker</a> to report a problem, or to suggest a new feature.</p>
</div>
<div class="section level2">
<h2 id="how-to-get-started">How to get started?<a class="anchor" aria-label="anchor" href="#how-to-get-started"></a>
</h2>
<div class="section level4">
<h4 id="id_1-you-are-not-yet-an-r-user">1. You are not yet an R user<a class="anchor" aria-label="anchor" href="#id_1-you-are-not-yet-an-r-user"></a>
</h4>
<p>In this case, start with understanding basic programming concepts, such as data structures (matrices, data frames, indexing these), <code>for</code> loops and functions in R. The online version of Garrett Grolemund’s <a href="https://rstudio-education.github.io/hopr/" class="external-link"><em>Hands-On Programming with R</em></a> walks you through these concepts nicely.</p>
</div>
<div class="section level4">
<h4 id="id_2-you-are-an-r-user-but-havent-used-vectorized-functions-yet">2. You are an R user but haven’t used vectorized functions yet<a class="anchor" aria-label="anchor" href="#id_2-you-are-an-r-user-but-havent-used-vectorized-functions-yet"></a>
</h4>
<p>Learn about vectorized functions designed to replace <code>for</code> loops: <code>lapply</code>, <code>sapply</code>, and <code>apply</code>. Here is a repository called <a href="https://github.com/psolymos/the-road-to-progress" class="external-link"><em>The Road to Progress</em></a> that I created to show you how to go from a <code>for</code> loop to <code>lapply</code>/<code>sapply</code>.</p>
<p><a href="https://www.youtube.com/watch?feature=player_embedded&amp;v=uyhIiTTrTJY" target="_blank" class="external-link"> <img src="https://img.youtube.com/vi/uyhIiTTrTJY/mqdefault.jpg" alt="Watch the video" width="240" height="180" border="0"></a></p>
</div>
<div class="section level4">
<h4 id="id_3-you-are-an-r-user-familiar-with-vectorized-functions">3. You are an R user familiar with vectorized functions<a class="anchor" aria-label="anchor" href="#id_3-you-are-an-r-user-familiar-with-vectorized-functions"></a>
</h4>
<p>In this case, you can simply add <code>pbapply::pb</code> before your <code>*apply</code> functions, e.g. <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code> will become <code><a href="reference/pbapply.html">pbapply::pbapply()</a></code>, etc. You can guess what happens. Now if you want to speed things up a little (or a lot), try <code>pbapply::pbapply(..., cl = 4)</code> to use 4 cores instead of 1.</p>
<p>If you are a Windows user, things get a bit more complicated, but not much. Check how to work with <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parallel::parLapply</a></code> to set up a snow type cluster or use a suitable future backend (see some examples <a href="#parallel-backends">below</a>). Have a look at the <a href="https://github.com/psolymos/the-road-to-progress" class="external-link"><em>The Road to Progress</em></a> repository to see more worked examples.</p>
</div>
<div class="section level4">
<h4 id="id_4-you-are-a-seasoned-r-developer-writing-your-own-packages">4. You are a seasoned R developer writing your own packages<a class="anchor" aria-label="anchor" href="#id_4-you-are-a-seasoned-r-developer-writing-your-own-packages"></a>
</h4>
<p>Read on, the next section is for you.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-add-pbapply-to-a-package">How to add pbapply to a package<a class="anchor" aria-label="anchor" href="#how-to-add-pbapply-to-a-package"></a>
</h2>
<p>There are two ways of adding the pbapply package to another package.</p>
<div class="section level4">
<h4 id="id_1-suggests-pbapply">1. Suggests: pbapply<a class="anchor" aria-label="anchor" href="#id_1-suggests-pbapply"></a>
</h4>
<p>Add pbapply to the <code>Suggests</code> field in the <code>DESCRIPTION</code>.</p>
<p>Use a conditional statement in your code to fall back on a base function in case of pbapply is not installed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"pbapply"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu">pbapply</span><span class="fu">::</span><span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>See a small example package <a href="https://github.com/psolymos/pbapplySuggests" class="external-link">here</a>.</p>
</div>
<div class="section level4">
<h4 id="id_2-dependsimports-pbapply">2. Depends/Imports: pbapply<a class="anchor" aria-label="anchor" href="#id_2-dependsimports-pbapply"></a>
</h4>
<p>Add pbapply to the <code>Depends</code> or <code>Imports</code> field in the <code>DESCRIPTION</code>.</p>
<p>Use the pbapply functions either as <code><a href="reference/pbapply.html">pbapply::pblapply()</a></code> or specify them in the <code>NAMESPACE</code> (<code>importFrom(pbapply, pblapply)</code>) and use it as <code><a href="reference/pbapply.html">pblapply()</a></code> (without the <code>::</code>). You’d have to add a comment <code>#' @importFrom pbapply pblapply</code> if you are <a href="https://roxygen2.r-lib.org/articles/namespace.html#imports" class="external-link">using roxygen2</a>.</p>
</div>
<div class="section level4">
<h4 id="customizing-the-progress-bar-in-your-package">Customizing the progress bar in your package<a class="anchor" aria-label="anchor" href="#customizing-the-progress-bar-in-your-package"></a>
</h4>
<p>Specify the progress bar options in the <code>zzz.R</code> file of the package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.onAttach</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">libname</span>, <span class="va">pkgname</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"pboptions"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        type <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="st">"timer"</span> <span class="kw">else</span> <span class="st">"none"</span>,</span>
<span>        char <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>        txt.width <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        gui.width <span class="op">=</span> <span class="fl">300</span>,</span>
<span>        style <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        initial <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"R progress bar"</span>,</span>
<span>        label <span class="op">=</span> <span class="st">""</span>,</span>
<span>        nout <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>        min_time <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This will set the options and pbapply will not override these when loaded.</p>
<p>See a small example package <a href="https://github.com/psolymos/pbapplyDepends" class="external-link">here</a>.</p>
</div>
<div class="section level4">
<h4 id="suppressing-the-progress-bar-in-your-functions">Suppressing the progress bar in your functions<a class="anchor" aria-label="anchor" href="#suppressing-the-progress-bar-in-your-functions"></a>
</h4>
<p>Suppressing the progress bar is sometimes handy. By default, progress bar is suppressed when <code>!interactive()</code>. In other instances, put this inside a function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span><span class="va">pbo</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="working-with-a-future-backend">Working with a future backend<a class="anchor" aria-label="anchor" href="#working-with-a-future-backend"></a>
</h4>
<p>The future backend might require additional arguments to be set by package developers to avoid warnings for end users. Most notably, you will have to determine how to handle random number generation as part of parallel evaluation. You can pass the <code>future.seed</code> argument directly through <code>...</code>. In general, ass any additional arguments to <code>FUN</code> immediately following the <code>FUN</code> argument, and any additional arguments to the the future backend after <code>cl = "future"</code> statement:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">pblapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">FUN =</span> my_fcn, {additional my_fcn args}, <span class="at">cl =</span> <span class="st">"future"</span>, {additional future args})</span></code></pre></div>
<p>See <a href="https://github.com/psolymos/pbapply/issues/60" class="external-link">this issue</a> for a discussion.</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following <code>pb*</code> functions are available in the pbapply package:</p>
<table class="table">
<thead><tr>
<th>base</th>
<th>pbapply</th>
<th>works in parallel</th>
</tr></thead>
<tbody>
<tr>
<td><code>apply</code></td>
<td><code>pbapply</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>by</code></td>
<td><code>pbby</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>eapply</code></td>
<td><code>pbeapply</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>lapply</code></td>
<td><code>pblapply</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>.mapply</code></td>
<td><code>pb.mapply</code></td>
<td>❌</td>
</tr>
<tr>
<td><code>mapply</code></td>
<td><code>pbmapply</code></td>
<td>❌</td>
</tr>
<tr>
<td><code>Map</code></td>
<td><code>pbMap</code></td>
<td>❌</td>
</tr>
<tr>
<td><code>replicate</code></td>
<td><code>pbreplicate</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>sapply</code></td>
<td><code>pbsapply</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>tapply</code></td>
<td><code>pbtapply</code></td>
<td>✅</td>
</tr>
<tr>
<td><code>vapply</code></td>
<td><code>pbvapply</code></td>
<td>✅</td>
</tr>
<tr>
<td>❌</td>
<td><code>pbwalk</code></td>
<td>✅</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="command-line-usage">Command line usage<a class="anchor" aria-label="anchor" href="#command-line-usage"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/psolymos/pbapply" class="external-link">pbapply</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="co">## model fitting and bootstrap</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, <span class="va">d</span><span class="op">)</span></span>
<span><span class="va">ndat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">bid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">B</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ndat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ndat</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ndat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ndat</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">call</span><span class="op">$</span><span class="va">formula</span>, data<span class="op">=</span><span class="va">ndat</span><span class="op">[</span><span class="va">z</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## standard '*apply' functions</span></span>
<span><span class="co"># system.time(res1 &lt;- lapply(1:B, function(i) fun(bid[,i])))</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.096   0.023   1.127</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">B</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">fun</span><span class="op">(</span><span class="va">bid</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.152   0.017   1.182</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">bid</span>, <span class="fl">2</span>, <span class="va">fun</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.134   0.010   1.160</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">B</span>, <span class="fu">fun</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.141   0.022   1.171</span></span>
<span></span>
<span><span class="co">## 'pb*apply' functions</span></span>
<span><span class="co">## try different settings:</span></span>
<span><span class="co">## "none", "txt", "tk", "win", "timer"</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"timer"</span><span class="op">)</span> <span class="co"># default</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res1pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">B</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">fun</span><span class="op">(</span><span class="va">bid</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% ~00s</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.539   0.046   1.599</span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"txt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res2pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pbapply.html">pbsapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">B</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">fun</span><span class="op">(</span><span class="va">bid</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#   |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.433   0.045   1.518</span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"txt"</span>, style<span class="op">=</span><span class="fl">1</span>, char<span class="op">=</span><span class="st">"="</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res3pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pbapply.html">pbapply</a></span><span class="op">(</span><span class="va">bid</span>, <span class="fl">2</span>, <span class="va">fun</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># ==================================================</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.389   0.032   1.464</span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"txt"</span>, char<span class="op">=</span><span class="st">":"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">res4pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pbapply.html">pbreplicate</a></span><span class="op">(</span><span class="va">B</span>, <span class="fu">fun</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#   |::::::::::::::::::::::::::::::::::::::::::::::::::| 100%</span></span>
<span><span class="co">#    user  system elapsed</span></span>
<span><span class="co">#   1.427   0.040   1.481</span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="parallel-backends">Parallel backends<a class="anchor" aria-label="anchor" href="#parallel-backends"></a>
</h4>
<p>You have a few different options to choose from as a backend. This all comes down to the <code>cl</code> argument in the <code>pb*</code> functions.</p>
<ul>
<li>
<code>cl = NULL</code> (default): sequential execution</li>
<li>
<code>cl</code> is of class cluster: this implies that you used <code>cl = parallel::makeCluster(n)</code> or something similar (<code>n</code> being the number of worker nodes)</li>
<li>
<code>cl</code> is a positive integer (usually &gt; 1): forking type parallelism is used in this case</li>
<li>
<code>cl = "future"</code>: you are using one of the <a href="https://CRAN.R-project.org/package=future" class="external-link">future</a> plans and parallelism is defined outside of the <code>pb*</code> call.</li>
</ul>
<p>Note that on Windows the forking type is not available and <code>pb*</code> functions will fall back to sequential evaluation.</p>
<p>Some examples:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## sequential</span></span>
<span><span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## cluster</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">f</span>, cl <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span>
<span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## forking</span></span>
<span><span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">f</span>, cl <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## future</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">cluster</span>, workers <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">f</span>, cl <span class="op">=</span> <span class="st">"future"</span><span class="op">)</span></span>
<span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pbapply.html">pblapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">f</span>, cl <span class="op">=</span> <span class="st">"future"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="progress-with-shiny">Progress with Shiny<a class="anchor" aria-label="anchor" href="#progress-with-shiny"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/psolymos/pbapply" class="external-link">pbapply</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/pboptions.html">pboptions</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"shiny"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Shiny progress"</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"Almost there ..."</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html" class="external-link">plotOutput</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html" class="external-link">renderPlot</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="reference/pbapply.html">pbsapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cars</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://github.com/psolymos/pbapply/raw/master/images/shiny.png"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=pbapply" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/psolymos/pbapply/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/psolymos/pbapply/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pbapply</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Peter Solymos <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7337-1740" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Zygmunt Zawadzki <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Peter Solymos, Zygmunt Zawadzki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
